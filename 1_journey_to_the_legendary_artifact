initial_energy = float(input())
mountain_count = 0
artifacts = 0

while initial_energy > 0:
    command = input()

    if command == "Journey ends here!":
        break

    if command == "mountain":
        initial_energy -= 10
        mountain_count += 1
        if mountain_count % 3 == 0:
            artifacts += 1
            if artifacts == 3:
                break

    elif command == "desert":
        initial_energy -= 15

    elif command == "forest":
        initial_energy += 7

if artifacts == 3:
    print(f"The character reached the legendary artifact with {initial_energy:.2f} energy left.")

elif initial_energy <= 0:
    print("The character is too exhausted to carry on with the journey.")

elif artifacts < 3:
    not_found_artifacts = 3 - artifacts
    print(
        f"The character could not find all the pieces and needs {not_found_artifacts} more to complete the legendary artifact.")
